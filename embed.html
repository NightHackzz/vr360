<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width">
<title>vr360 viewer samples</title>
<script src="js/poxp_all.js?20180610"></script>
<script type="text/javascript">
function $(e){return document.getElementById(e)}
onload = function() {
	document.querySelectorAll('div.v360').forEach((o)=>{
		const sb = document.createElement("div")
		sb.innerHTML = "<div class=sbtn>▶︎</div>"
		o.appendChild(sb) ;
		sb.addEventListener("click", (ev)=>{
			ev.target.style.display = "none" ;	
			setvr360(o,{src:o.getAttribute("data-src"),mode:o.getAttribute("data-mode")})
		})
	})
}
function setvr360(base,param) {
	const p = `<div class=cc>
 <label><input type=checkbox id=autorot>rotate</label>
 <div class=pui></div></div>
<div class=loading><img src="img/guruguru.gif"></div>
<div class=vrbtn></div>
<div class=footer><a href="https://github.com/wakufactory/vr360/" target="_blank">vr360 viewer</a></div>`
	const div = document.createElement("div")
	div.innerHTML = p 
	base.appendChild(div)
	const can = document.createElement("canvas") 
	base.appendChild(can)
	var poxp = new PoxPlayer(can) ;
	var ss ;
	if(param.mode>0) poxp.param.isStereo=true 
	poxp.load("js/theta_view_vr14.json").then(function(src) {
		ss = src ;
		poxp.set(src,{param:[param.src,param.mode]}).then(function(pox){
//			if(pox.setting.copyright) $("footer").innerHTML += "&nbsp;&nbsp;"+pox.setting.copyright;
//			poxp.setParam($('pui'))
//			if(pox.setting.title) document.title = pox.setting.title + " - PoExE Player"
		})
	}).catch(function(err) {
		base.querySelector(".loading").style.display = "none" ;
		alert(err) ;
	})
	poxp.renderStart = function() {
		base.querySelector(".thumb").style.display = "none" ;	
		base.querySelector(".loading").style.display = "none" ;	
	}
	poxp.setError( function(msg) {
		console.log(msg) ;
	})
	window.addEventListener("deviceorientation", function(ev) {
		var or = window.orientation ;
		var d = (or==90||or==-90)&&poxp.param.isStereo ;
		$("cc").style.opacity = d?0.:0.4 ;
		$("footer").style.display = d?"none":"block" ;
		$("vrbtn").style.display = d?"none":"block" ;
	})
	base.querySelector(".vrbtn").addEventListener("click", (ev)=>{
		poxp.enterVR()
	}) 
}
</script>
<link rel="stylesheet" type="text/css" href="css/vr360_embed.css">
<style type="text/css">
div.v360 {
	width:400px ;
	height:200px ;
}
</style>
</head>
<body>
<h1>vr360 viewer samples</h1>
click photos to launch viewer 
<h2>360° Omnidirectional photo </h2>
<ul>
	<li><div class=v360 data-src="sample/R0010392.JPG">
		<img class=thumb src="sample/R0010392_s.jpg"></div>
		(photo by THETA SC)</li>	
</ul>
<h2>360° Omnidirectional Stereo photo </h2>
<ul>
	<li><div class=v360 data-src="sample/R0010220_st.JPG" data-mode="1"><img class=thumb src="sample/R0010220_st_s.jpg"></div> (photo by THETA SC)</li>
</ul>
<h2>180° half Omnidirectional Stereo photo</h2>
<ul>
	<li><img src="sample/t180_ina_s.jpg"> (photo by THETA SC)</li>	
</ul>
<h3>repository</h3>
<a href="https://github.com/wakufactory/vr360">github</a>


</body>
</html>